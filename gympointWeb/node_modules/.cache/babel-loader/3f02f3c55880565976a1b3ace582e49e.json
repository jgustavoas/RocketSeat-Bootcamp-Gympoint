{"ast":null,"code":"import _slicedToArray from \"/home/gustavo/Rocketseat/Bootcamp/Desafios/gympointWeb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/gustavo/Rocketseat/Bootcamp/Desafios/gympointWeb/src/pages/Matriculations/form.js\";\nimport React, { useState, useMemo, useEffect } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { format, parseISO, addMonths, getDay, getDate, getMonth, getYear } from 'date-fns';\nimport { utcToZonedTime } from 'date-fns-tz';\nimport pt from 'date-fns/locale/pt';\nimport { MdArrowBack, MdCheck } from 'react-icons/md';\nimport api from \"../../services/api\";\nimport { request } from \"../../store/modules/data/actions\";\nimport history from \"../../services/history\";\nexport default function Dashboard() {\n  const dispatch = useDispatch();\n\n  const _useState = useState([]),\n        _useState2 = _slicedToArray(_useState, 2),\n        matriculation = _useState2[0],\n        setMatriculation = _useState2[1];\n\n  const active = matriculation.active,\n        studentId = matriculation.studentId,\n        planId = matriculation.planId,\n        price = matriculation.price,\n        studentName = matriculation.studentName,\n        planTitle = matriculation.planTitle,\n        planDuration = matriculation.planDuration,\n        start_date = matriculation.start_date,\n        start_dateFormated = matriculation.start_dateFormated,\n        end_date = matriculation.end_date,\n        end_dateFormated = matriculation.end_dateFormated,\n        newEndDate = matriculation.newEndDate;\n  console.tron.log(matriculation);\n\n  const _useState3 = useState([]),\n        _useState4 = _slicedToArray(_useState3, 2),\n        plans = _useState4[0],\n        setPlans = _useState4[1];\n\n  const params = new URL(document.location).searchParams;\n  const matriculationId = params.get('id') ? params.get('id') : '';\n  useEffect(() => {\n    async function plansData() {\n      const response = await api.get(`plans`);\n      setPlans(response.data);\n    }\n\n    setMatriculation(plansData);\n\n    async function matriculationData() {\n      const response = await api.get(`matriculations/${matriculationId}`);\n      const formatStartDate = format(parseISO(response.data.start_date), 'yyyy-MM-dd', {\n        locale: pt\n      });\n      const newEndDate = format(addMonths(new Date(formatStartDate), 3), 'dd/MM/yyyy');\n      const matriculationData = {\n        active: response.data.active,\n        matriculationId: response.data.id,\n        studentId: response.data.student_id,\n        planId: response.data.plan_id,\n        price: response.data.price,\n        studentName: response.data.students.name,\n        planTitle: response.data.plans.title,\n        planDuration: 0,\n        start_date: response.data.start_date,\n        start_dateFormated: formatStartDate,\n        end_date: response.data.end_date,\n        end_dateFormated: format(parseISO(response.data.end_date), 'dd/MM/yyyy', {\n          locale: pt\n        }),\n        newEndDate\n      };\n      setMatriculation(matriculationData);\n    }\n\n    if (matriculationId !== '') {\n      matriculationData();\n    }\n  }, [matriculationId]);\n\n  function handleSubmit(formData) {\n    const plan_id = formData.plan_id,\n          start_date = formData.start_date,\n          end_date = formData.end_date;\n    const action = matriculationId ? request('UPDATE', 'matriculations', formData) : request('CREATE', 'matriculations', {\n      plan_id,\n      start_date,\n      end_date\n    });\n    dispatch(action);\n  }\n\n  function goTo(page) {\n    history.push(`/${page}`);\n  }\n\n  function formatEndDate(refDate, planDuration) {\n    return format(addMonths(new Date(refDate), planDuration), 'dd/MM/yyyy');\n  }\n\n  function handleEvent(planValue, start_dateFormated) {\n    setMatriculation({\n      active,\n      matriculationId,\n      studentId,\n      planId: planValue.id,\n      planDuration: planValue.duration,\n      price,\n      studentName,\n      planTitle,\n      start_dateFormated,\n      start_date,\n      newEndDate\n    });\n  }\n\n  return React.createElement(React.Fragment, null, React.createElement(\"header\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134\n    },\n    __self: this\n  }, React.createElement(\"h1\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135\n    },\n    __self: this\n  }, \"Cadastro de matr\\xEDcula\"), React.createElement(\"aside\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136\n    },\n    __self: this\n  }, React.createElement(\"button\", {\n    type: \"button\",\n    className: \"greyButton\",\n    onClick: () => goTo('matriculations'),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137\n    },\n    __self: this\n  }, React.createElement(MdArrowBack, {\n    size: 16,\n    color: \"#ee4d64\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142\n    },\n    __self: this\n  }), \" VOLTAR\"), React.createElement(\"button\", {\n    type: \"button\",\n    onClick: () => handleSubmit(matriculation),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144\n    },\n    __self: this\n  }, React.createElement(MdCheck, {\n    size: 16,\n    color: \"#fff\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145\n    },\n    __self: this\n  }), \" SALVAR\"))), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149\n    },\n    __self: this\n  }, React.createElement(\"form\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    htmlFor: \"name\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151\n    },\n    __self: this\n  }, \"NOME DO ALUNO\"), React.createElement(\"input\", {\n    type: \"text\",\n    name: \"name\",\n    id: \"name\" // disabled={matriculationId === '' ? '' : 'disabled'}\n    ,\n    value: studentName,\n    onChange: event => setMatriculation({\n      active,\n      matriculationId,\n      studentId,\n      planId,\n      planDuration,\n      price,\n      studentName: event.target.value,\n      planTitle,\n      start_dateFormated\n    }),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    htmlFor: \"name\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174\n    },\n    __self: this\n  }, \"PLANO\"), React.createElement(\"select\", {\n    name: \"plans\",\n    onChange: event => handleEvent(JSON.parse(event.target.value), start_dateFormated),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175\n    },\n    __self: this\n  }, plans.map(plan => React.createElement(\"option\", {\n    selected: matriculation.planId === plan.id ? 'selected' : '',\n    value: `{\"id\":${plan.id}, \"duration\":${plan.duration}`,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185\n    },\n    __self: this\n  }, `${plan.title} (R$${plan.price},00 / ${plan.duration} ${plan.duration > 1 ? 'meses' : 'mÃªs'})`)))), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    htmlFor: \"name\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199\n    },\n    __self: this\n  }, \"DATA DE IN\\xCDCIO\"), React.createElement(\"input\", {\n    type: \"date\",\n    value: start_dateFormated,\n    name: \"startDateInput\",\n    onChange: event => setMatriculation({\n      active,\n      matriculationId,\n      studentId,\n      planId,\n      planDuration,\n      price,\n      studentName,\n      planTitle,\n      start_dateFormated: event.target.value,\n      start_date,\n      newEndDate: formatEndDate(event.target.value, 6)\n    }),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    htmlFor: \"name\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222\n    },\n    __self: this\n  }, \"DATA DE T\\xC9RMINO\"), React.createElement(\"input\", {\n    type: \"text\",\n    disabled: \"disabled\",\n    name: \"\",\n    id: \"\",\n    value: newEndDate,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 223\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 231\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    htmlFor: \"name\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232\n    },\n    __self: this\n  }, \"VALOR TOTAL\"), React.createElement(\"input\", {\n    disabled: \"disabled\",\n    value: price,\n    type: \"text\",\n    name: \"\",\n    id: \"\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233\n    },\n    __self: this\n  }))))));\n}","map":{"version":3,"sources":["/home/gustavo/Rocketseat/Bootcamp/Desafios/gympointWeb/src/pages/Matriculations/form.js"],"names":["React","useState","useMemo","useEffect","useDispatch","format","parseISO","addMonths","getDay","getDate","getMonth","getYear","utcToZonedTime","pt","MdArrowBack","MdCheck","api","request","history","Dashboard","dispatch","matriculation","setMatriculation","active","studentId","planId","price","studentName","planTitle","planDuration","start_date","start_dateFormated","end_date","end_dateFormated","newEndDate","console","tron","log","plans","setPlans","params","URL","document","location","searchParams","matriculationId","get","plansData","response","data","matriculationData","formatStartDate","locale","Date","id","student_id","plan_id","students","name","title","handleSubmit","formData","action","goTo","page","push","formatEndDate","refDate","handleEvent","planValue","duration","event","target","value","JSON","parse","map","plan"],"mappings":"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","sourcesContent":["import React, { useState, useMemo, useEffect } from 'react';\nimport { useDispatch } from 'react-redux';\nimport {\n  format,\n  parseISO,\n  addMonths,\n  getDay,\n  getDate,\n  getMonth,\n  getYear,\n} from 'date-fns';\nimport { utcToZonedTime } from 'date-fns-tz';\nimport pt from 'date-fns/locale/pt';\nimport { MdArrowBack, MdCheck } from 'react-icons/md';\nimport api from '~/services/api';\n\nimport { request } from '~/store/modules/data/actions';\n\nimport history from '~/services/history';\n\nexport default function Dashboard() {\n  const dispatch = useDispatch();\n\n  const [matriculation, setMatriculation] = useState([]);\n  const {\n    active,\n    studentId,\n    planId,\n    price,\n    studentName,\n    planTitle,\n    planDuration,\n    start_date,\n    start_dateFormated,\n    end_date,\n    end_dateFormated,\n    newEndDate,\n  } = matriculation;\n\n  console.tron.log(matriculation);\n\n  const [plans, setPlans] = useState([]);\n\n  const params = new URL(document.location).searchParams;\n  const matriculationId = params.get('id') ? params.get('id') : '';\n\n  useEffect(() => {\n    async function plansData() {\n      const response = await api.get(`plans`);\n      setPlans(response.data);\n    }\n    setMatriculation(plansData);\n\n    async function matriculationData() {\n      const response = await api.get(`matriculations/${matriculationId}`);\n\n      const formatStartDate = format(\n        parseISO(response.data.start_date),\n        'yyyy-MM-dd',\n        {\n          locale: pt,\n        }\n      );\n\n      const newEndDate = format(\n        addMonths(new Date(formatStartDate), 3),\n        'dd/MM/yyyy'\n      );\n\n      const matriculationData = {\n        active: response.data.active,\n        matriculationId: response.data.id,\n        studentId: response.data.student_id,\n        planId: response.data.plan_id,\n        price: response.data.price,\n        studentName: response.data.students.name,\n        planTitle: response.data.plans.title,\n        planDuration: 0,\n        start_date: response.data.start_date,\n        start_dateFormated: formatStartDate,\n        end_date: response.data.end_date,\n        end_dateFormated: format(\n          parseISO(response.data.end_date),\n          'dd/MM/yyyy',\n          {\n            locale: pt,\n          }\n        ),\n        newEndDate,\n      };\n\n      setMatriculation(matriculationData);\n    }\n\n    if (matriculationId !== '') {\n      matriculationData();\n    }\n  }, [matriculationId]);\n\n  function handleSubmit(formData) {\n    const { plan_id, start_date, end_date } = formData;\n    const action = matriculationId\n      ? request('UPDATE', 'matriculations', formData)\n      : request('CREATE', 'matriculations', { plan_id, start_date, end_date });\n    dispatch(action);\n  }\n\n  function goTo(page) {\n    history.push(`/${page}`);\n  }\n\n  function formatEndDate(refDate, planDuration) {\n    return format(addMonths(new Date(refDate), planDuration), 'dd/MM/yyyy');\n  }\n\n  function handleEvent(planValue, start_dateFormated) {\n    setMatriculation({\n      active,\n      matriculationId,\n      studentId,\n      planId: planValue.id,\n      planDuration: planValue.duration,\n      price,\n      studentName,\n      planTitle,\n      start_dateFormated,\n      start_date,\n      newEndDate,\n    });\n  }\n\n  return (\n    <>\n      <header>\n        <h1>Cadastro de matrÃ­cula</h1>\n        <aside>\n          <button\n            type='button'\n            className='greyButton'\n            onClick={() => goTo('matriculations')}\n          >\n            <MdArrowBack size={16} color='#ee4d64' /> VOLTAR\n          </button>\n          <button type='button' onClick={() => handleSubmit(matriculation)}>\n            <MdCheck size={16} color='#fff' /> SALVAR\n          </button>\n        </aside>\n      </header>\n      <div>\n        <form>\n          <label htmlFor='name'>NOME DO ALUNO</label>\n          <input\n            type='text'\n            name='name'\n            id='name'\n            // disabled={matriculationId === '' ? '' : 'disabled'}\n            value={studentName}\n            onChange={event =>\n              setMatriculation({\n                active,\n                matriculationId,\n                studentId,\n                planId,\n                planDuration,\n                price,\n                studentName: event.target.value,\n                planTitle,\n                start_dateFormated,\n              })\n            }\n          />\n          <div>\n            <div>\n              <label htmlFor='name'>PLANO</label>\n              <select\n                name='plans'\n                onChange={event =>\n                  handleEvent(\n                    JSON.parse(event.target.value),\n                    start_dateFormated\n                  )\n                }\n              >\n                {plans.map(plan => (\n                  <option\n                    selected={\n                      matriculation.planId === plan.id ? 'selected' : ''\n                    }\n                    value={`{\"id\":${plan.id}, \"duration\":${plan.duration}`}\n                  >\n                    {`${plan.title} (R$${plan.price},00 / ${plan.duration} ${\n                      plan.duration > 1 ? 'meses' : 'mÃªs'\n                    })`}\n                  </option>\n                ))}\n              </select>\n            </div>\n            <div>\n              <label htmlFor='name'>DATA DE INÃCIO</label>\n              <input\n                type='date'\n                value={start_dateFormated}\n                name='startDateInput'\n                onChange={event =>\n                  setMatriculation({\n                    active,\n                    matriculationId,\n                    studentId,\n                    planId,\n                    planDuration,\n                    price,\n                    studentName,\n                    planTitle,\n                    start_dateFormated: event.target.value,\n                    start_date,\n                    newEndDate: formatEndDate(event.target.value, 6),\n                  })\n                }\n              />\n            </div>\n            <div>\n              <label htmlFor='name'>DATA DE TÃRMINO</label>\n              <input\n                type='text'\n                disabled='disabled'\n                name=''\n                id=''\n                value={newEndDate}\n              />\n            </div>\n            <div>\n              <label htmlFor='name'>VALOR TOTAL</label>\n              <input\n                disabled='disabled'\n                value={price}\n                type='text'\n                name=''\n                id=''\n              />\n            </div>\n          </div>\n        </form>\n      </div>\n    </>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}